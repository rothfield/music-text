<!DOCTYPE html>
<html>
<head>
    <title>VexFlow Barline Debug</title>
    <script src="lib/vexflow5.js"></script>
</head>
<body>
    <h1>VexFlow Barline Debug</h1>
    <div id="output"></div>
    
    <script>
        console.log('VexFlow object:', VexFlow);
        console.log('VexFlow.Barline:', VexFlow.Barline);
        
        if (VexFlow.Barline) {
            console.log('VexFlow.Barline.type:', VexFlow.Barline.type);
        }
        
        const { Renderer, Stave, Voice, Formatter, StaveNote } = VexFlow;
        
        // Create renderer
        const div = document.getElementById("output");
        const renderer = new Renderer(div, Renderer.Backends.SVG);
        renderer.resize(800, 300);
        const context = renderer.getContext();
        
        // Test 1: Repeat end barline only
        let currentY = 20;
        
        const stave1 = new Stave(10, currentY, 700);
        stave1.addClef('treble');
        
        console.log('Testing setEndBarType with different values...');
        
        // Try different ways to set repeat end barline
        try {
            console.log('Trying REPEAT_END...');
            stave1.setEndBarType('REPEAT_END');
            console.log('SUCCESS: REPEAT_END worked');
        } catch (e) {
            console.error('REPEAT_END failed:', e);
            try {
                console.log('Trying repeat-end...');
                stave1.setEndBarType('repeat-end');
                console.log('SUCCESS: repeat-end worked');
            } catch (e2) {
                console.error('repeat-end failed:', e2);
                try {
                    console.log('Trying REPEAT_BOTH...');
                    stave1.setEndBarType('REPEAT_BOTH');
                    console.log('SUCCESS: REPEAT_BOTH worked');
                } catch (e3) {
                    console.error('REPEAT_BOTH failed:', e3);
                }
            }
        }
        
        stave1.setContext(context).draw();
        
        // Test 2: Both repeat barlines
        currentY += 100;
        const stave2 = new Stave(10, currentY, 700);
        
        try {
            stave2.setBegBarType('REPEAT_BEGIN');
            stave2.setEndBarType('REPEAT_END');
        } catch (e) {
            console.error('Both barlines failed:', e);
        }
        
        stave2.setContext(context).draw();
        
        // Create some notes
        const notes = [
            new StaveNote({ keys: ["c/4"], duration: "q" }),
            new StaveNote({ keys: ["d/4"], duration: "q" }),
            new StaveNote({ keys: ["e/4"], duration: "q" }),
            new StaveNote({ keys: ["f/4"], duration: "q" }),
        ];
        
        // Create voice and add notes
        const voice = new Voice({ num_beats: 4, beat_value: 4 });
        voice.addTickables(notes);
        
        // Format and draw on first stave
        new Formatter().joinVoices([voice]).format([voice], 650);
        voice.draw(context, stave1);
        
        console.log('Barline debug test completed');
    </script>
</body>
</html>