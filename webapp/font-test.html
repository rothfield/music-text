<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monospace Unicode Font Test</title>
    <style>
        /* Import the same font declarations */
        @font-face {
            font-family: 'JuliaMono';
            src: url('assets/JuliaMono-Regular.woff2') format('woff2');
            font-weight: normal;
            font-style: normal;
        }
        
        @font-face {
            font-family: 'Kurinto Mono';
            src: url('assets/KurintoMono-Regular.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
        }
        
        @font-face {
            font-family: 'Cascadia Code';
            src: url('assets/CascadiaCode-Regular.woff2') format('woff2');
            font-weight: normal;
            font-style: normal;
        }

        .test-container {
            font-size: 24px;
            font-weight: bold;
            line-height: 1.2;
            margin: 20px 0;
            padding: 10px;
            border: 1px solid #ccc;
        }
        
        .test-char {
            display: inline-block;
            border: 1px solid red;
            margin: 1px;
        }
        
        #results {
            margin-top: 20px;
            padding: 20px;
            background: #f5f5f5;
            border-radius: 5px;
            font-family: monospace;
            white-space: pre;
        }
        
        .pass { color: green; font-weight: bold; }
        .fail { color: red; font-weight: bold; }
    </style>
</head>
<body>
    <h1>Monospace Unicode Font Test</h1>
    <p>Testing character width consistency for musical notation characters:</p>
    
    <div id="test-containers"></div>
    <div id="results"></div>
    
    <script>
        const fonts = [
            'JuliaMono',
            'Kurinto Mono', 
            'Cascadia Code',
            'DejaVu Sans Mono',
            'JetBrains Mono',
            'Source Code Pro',
            'Roboto Mono'
        ];
        
        const testChars = [
            '-',  // ASCII dash
            '▬',  // Unicode dash replacement
            '.',  // ASCII dot
            '•',  // Unicode dot replacement  
            '|',  // ASCII pipe
            '┃',  // Unicode pipe replacement
            '1',  // Regular character for comparison
            'A'   // Another regular character
        ];
        
        function measureCharWidth(char, fontFamily) {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            ctx.font = `bold 24px ${fontFamily}, monospace`;
            return ctx.measureText(char).width;
        }
        
        function testFont(fontFamily) {
            const results = [];
            const widths = testChars.map(char => ({
                char,
                width: measureCharWidth(char, fontFamily)
            }));
            
            // Check if all widths are equal (within 0.1px tolerance)
            const baseWidth = widths[0].width;
            const tolerance = 0.1;
            const isMonospace = widths.every(({width}) => 
                Math.abs(width - baseWidth) <= tolerance
            );
            
            return {
                font: fontFamily,
                widths,
                isMonospace,
                baseWidth
            };
        }
        
        function runTests() {
            const results = fonts.map(testFont);
            
            // Create visual test containers
            const container = document.getElementById('test-containers');
            fonts.forEach(font => {
                const div = document.createElement('div');
                div.className = 'test-container';
                div.style.fontFamily = `${font}, monospace`;
                div.innerHTML = `<strong>${font}:</strong><br>` +
                    testChars.map(char => `<span class="test-char">${char}</span>`).join('');
                container.appendChild(div);
            });
            
            // Display results
            const resultsDiv = document.getElementById('results');
            let report = 'MONOSPACE UNICODE FONT TEST RESULTS\\n';
            report += '=' + '='.repeat(50) + '\\n\\n';
            
            results.forEach(result => {
                const status = result.isMonospace ? 'PASS' : 'FAIL';
                const statusClass = result.isMonospace ? 'pass' : 'fail';
                
                report += `${result.font}: `;
                resultsDiv.innerHTML += `<span class="${statusClass}">${status}</span>\\n`;
                
                result.widths.forEach(({char, width}) => {
                    report += `  ${char}: ${width.toFixed(2)}px\\n`;
                });
                report += `  Base width: ${result.baseWidth.toFixed(2)}px\\n`;
                report += `  Monospace: ${status}\\n\\n`;
            });
            
            resultsDiv.textContent = report;
            
            // Summary
            const passCount = results.filter(r => r.isMonospace).length;
            const summary = `\\nSUMMARY: ${passCount}/${results.length} fonts maintain monospace alignment with Unicode characters`;
            resultsDiv.textContent += summary;
            
            // Recommendations
            const bestFonts = results.filter(r => r.isMonospace).map(r => r.font);
            if (bestFonts.length > 0) {
                resultsDiv.textContent += `\\n\\nRECOMMENDED FONTS: ${bestFonts.join(', ')}`;
            }
            
            return results;
        }
        
        // Run tests when page loads
        window.addEventListener('load', () => {
            setTimeout(runTests, 500); // Wait for fonts to load
        });
    </script>
</body>
</html>